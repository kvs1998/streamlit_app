SELECT 
    dt.database_name,
    dt.schema_name,
    dt.name AS dynamic_table_name,
    t.name AS task_name,
    t.warehouse AS warehouse_name,
    w.size AS warehouse_size
FROM snowflake.account_usage.dynamic_tables dt
JOIN snowflake.account_usage.tasks t
    ON dt.task_id = t.id
JOIN snowflake.account_usage.warehouses w
    ON t.warehouse = w.name
ORDER BY dt.database_name, dt.schema_name, dt.name;
