
==================================

my_snowflake_db_project/
├── liquibase.properties
├── db.changelog-master.yaml        # Master orchestrator
├── lib/
│   └── snowflake-jdbc-3.latest.jar
└── changes/
    ├── core/                       # Core schema components (often stable)
    │   ├── 001_users_table.yaml
    │   └── 002_audit_log_table.yaml
    ├── features/
    │   ├── sales_management/       # All changes for the sales feature
    │   │   ├── 001_sales_table.yaml
    │   │   ├── 002_products_table.yaml
    │   │   ├── 003_add_promotions_column.yaml
    │   │   └── views/
    │   │       └── sales_dashboard_view.sql
    │   └── inventory_management/   # All changes for inventory feature
    │       ├── 001_inventory_table.yaml
    │       └── 002_supplier_table.yaml
    └── data/                       # Initial data inserts, lookup tables, etc.
        ├── 001_seed_initial_users.yaml
        ├── 002_seed_product_categories.yaml
        └── reference_data/
            └── regions_lookup.yaml

# my_snowflake_db_project/db.changelog-master.yaml

databaseChangeLog:
  # Core schema setup
  - include:
      file: changes/core/001_users_table.yaml
  - include:
      file: changes/core/002_audit_log_table.yaml

  # Sales Management Feature
  - include:
      file: changes/features/sales_management/001_sales_table.yaml
  - include:
      file: changes/features/sales_management/002_products_table.yaml
  - include:
      file: changes/features/sales_management/003_add_promotions_column.yaml
  - include:
      file: changes/features/sales_management/views/sales_dashboard_view.sql # Referencing a raw SQL file in a nested path

  # Inventory Management Feature
  - include:
      file: changes/features/inventory_management/001_inventory_table.yaml
  - include:
      file: changes/features/inventory_management/002_supplier_table.yaml

  # Data seeding
  - include:
      file: changes/data/001_seed_initial_users.yaml
  - include:
      file: changes/data/002_seed_product_categories.yaml
  - include:
      file: changes/data/reference_data/regions_lookup.yaml



# my_snowflake_db_project/db.changelog-master.yaml

databaseChangeLog:
  # Include all changelogs in the 'core' directory (sorted alphabetically by filename)
  - includeAll:
      path: changes/core/

  # Include all changelogs in the 'sales_management' directory
  - includeAll:
      path: changes/features/sales_management/

  # Explicitly include a specific data seeding file
  - include:
      file: changes/data/001_seed_initial_users.yaml

  # Include all changelogs in the 'reference_data' directory
  - includeAll:
      path: changes/data/reference_data/



===============================


my_snowflake_db_project/
├── liquibase.properties          # Liquibase configuration (DB connection, master changelog path)
├── db.changelog-master.yaml      # The master changelog that orchestrates all changes
├── lib/                          # Directory for custom JDBC drivers (if not bundled)
│   └── snowflake-jdbc-3.latest.jar # (Optional) If you need a specific driver version
└── changes/                      # Directory for individual, granular changelogs
    ├── 001_initial_schema.yaml   # Initial table creations, sequences, etc.
    ├── 002_add_sales_table.yaml  # Feature-specific or table-specific changes
    ├── 003_add_products_table.yaml
    └── 004_insert_initial_data.yaml


# my_snowflake_db_project/db.changelog-master.yaml

databaseChangeLog:
  # Initial setup of core tables and objects
  - include:
      file: changes/001_initial_schema.yaml

  # Feature: Sales Management
  - include:
      file: changes/002_add_sales_table.yaml
  - include:
      file: changes/003_add_products_table.yaml

  # Data seeding (often separated from schema changes)
  - include:
      file: changes/004_insert_initial_data.yaml

  # Add more includes here as your project evolves
  # For example:
  # - include:
  #     file: changes/005_add_customer_details.yaml
  # - include:
  #     file: changes/006_create_reporting_views.sql # Can include raw SQL files too!



# my_snowflake_db_project/changes/001_initial_schema.yaml

databaseChangeLog:
  - changeSet:
      id: create-users-table
      author: amit
      comment: Creates the initial users table
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: user_id
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                    startWith: 1 # Snowflake IDENTITY property equivalent
                    incrementBy: 1
              - column:
                  name: username
                  type: VARCHAR(255)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(255)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP_NTZ
                  defaultValueComputed: CURRENT_TIMESTAMP() # Snowflake specific function




# my_snowflake_db_project/changes/002_add_sales_table.yaml

databaseChangeLog:
  - changeSet:
      id: create-sales-table
      author: amit
      comment: Creates the sales transaction table
      changes:
        - createTable:
            tableName: sales
            columns:
              - column:
                  name: sale_id
                  type: NUMBER(38,0) # Snowflake's INT is really NUMBER(38,0)
                  constraints:
                    primaryKey: true
                    nullable: false
                    startWith: 1
                    incrementBy: 1
              - column:
                  name: user_id
                  type: INT
                  constraints:
                    nullable: false
                    references: users(user_id) # Foreign key to the users table
                    foreignKeyName: fk_sales_user
              - column:
                  name: sale_date
                  type: DATE
                  constraints:
                    nullable: false
              - column:
                  name: total_amount
                  type: NUMBER(10, 2)
                  constraints:
                    nullable: false
              - column:
                  name: status
                  type: VARCHAR(50)
                  defaultValue: 'PENDING'


# my_snowflake_db_project/changes/003_add_products_table.yaml

databaseChangeLog:
  - changeSet:
      id: create-products-table
      author: amit
      comment: Creates the products catalog table
      changes:
        - createTable:
            tableName: products
            columns:
              - column:
                  name: product_id
                  type: INT
                  constraints:
                    primaryKey: true
                    nullable: false
                    startWith: 1
                    incrementBy: 1
              - column:
                  name: product_name
                  type: VARCHAR(255)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: description
                  type: VARCHAR(1000)
              - column:
                  name: price
                  type: NUMBER(10, 2)
                  constraints:
                    nullable: false


# my_snowflake_db_project/changes/004_insert_initial_data.yaml
# my_snowflake_db_project/changes/004_insert_initial_data.yaml

databaseChangeLog:
  - changeSet:
      id: insert-initial-users
      author: amit
      comment: Inserts some initial user data into the users table
      changes:
        - insert:
            tableName: users
            columns:
              - column: {name: user_id, value: 101}
              - column: {name: username, value: "admin_user"}
              - column: {name: email, value: "admin@example.com"}
        - insert:
            tableName: users
            columns:
              - column: {name: user_id, value: 102}
              - column: {name: username, value: "test_user"}
              - column: {name: email, value: "test@example.com"}

  - changeSet:
      id: insert-initial-products
      author: amit
      comment: Inserts some initial product data into the products table
      changes:
        - insert:
            tableName: products
            columns:
              - column: {name: product_id, value: 1}
              - column: {name: product_name, value: "Laptop"}
              - column: {name: description, value: "High-performance laptop"}
              - column: {name: price, value: 1200.00}
        - insert:
            tableName: products
            columns:
              - column: {name: product_id, value: 2}
              - column: {name: product_name, value: "Mouse"}
              - column: {name: description, value: "Wireless ergonomic mouse"}
              - column: {name: price, value: 35.00}

  - changeSet:
      id: insert-initial-sales
      author: amit
      comment: Inserts some initial sales data into the sales table
      changes:
        - insert:
            tableName: sales
            columns:
              - column: {name: sale_id, value: 1001}
              - column: {name: user_id, value: 101} # References admin_user
              - column: {name: sale_date, value: "2024-09-10"}
              - column: {name: total_amount, value: 1200.00}
              - column: {name: status, value: "COMPLETED"}
        - insert:
            tableName: sales
            columns:
              - column: {name: sale_id, value: 1002}
              - column: {name: user_id, value: 102} # References test_user
              - column: {name: sale_date, value: "2024-09-11"}
              - column: {name: total_amount, value: 35.00}
              - column: {name: status, value: "PENDING"}
        - insert:
            tableName: sales
            columns:
              - column: {name: sale_id, value: 1003}
              - column: {name: user_id, value: 101} # References admin_user
              - column: {name: sale_date, value: "2024-09-12"}
              - column: {name: total_amount, value: 2400.00}
              - column: {name: status, value: "COMPLETED"}
